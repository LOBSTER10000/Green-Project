<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sunny.green.dao.PickupDao">
    <!--  pickup Address에 값 입력  -->
    <insert id="pickupAddressSave"  useGeneratedKeys="true" keyProperty="pu_address_no">
        Insert into pickup_address(user_id, pu_address_name, pu_address_tel, pu_address_zip, pu_address1, pu_address2, pu_address3, pu_address4)
        values (#{user_id}, #{pu_address_name}, #{pu_address_tel}, #{pu_address_zip}, #{pu_address1}, #{pu_address2}, #{pu_address3},#{pu_address4})
        <selectKey keyProperty="pu_address_no" resultType="int" order="AFTER">
            SELECT LAST_INSERT_ID();
        </selectKey>
    </insert>
    <insert id="pickupInfoSave" useGeneratedKeys="true" keyProperty="pu_no">
        Insert into pickup_info(pu_address_no, user_id, house_no, pu_elevator, pu_day, pu_img, pu_memo)
        values (#{pu_address_no}, #{user_id}, #{house_no}, #{pu_elevator}, #{pu_day}, #{pu_img}, #{text_memo})
        <selectKey keyProperty="pu_no" resultType="int" order="AFTER">
            SELECT LAST_INSERT_ID();
        </selectKey>
    </insert>
    <insert id="pickupCategorySave">
        Insert into pickup_category(pu_no, category_no, pu_category_count)
        values (#{pu_no}, #{category_no}, #{pu_category_count})
    </insert>
    <insert id="pickupImgSave" useGeneratedKeys="true" keyProperty="pu_img_no">
        Insert into pickup_img(pu_img_origin_name, pu_img_save_name, pu_img_path)
        values (#{pu_img_origin_name}, #{pu_img_save_name}, #{pu_img_path})
        <selectKey keyProperty="pu_img_no" resultType="int" order="AFTER">
            SELECT LAST_INSERT_ID();
        </selectKey>
    </insert>
    <update id="pickupImgUpdate">
        UPDATE pickup_img set pu_no = #{pu_no} where pu_img_no = #{pu_img_no}
    </update>

</mapper>